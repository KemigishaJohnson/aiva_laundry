<!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>AIVA Laundry - Admin Dashboard</title>
      <link rel="stylesheet" href="/static/styles.css">
  </head>
  <body>
      <nav>
          <div class="logo">
              <img src="/static/logo.png" alt="AIVA Logo" style="height: 40px; transition: transform 0.3s;" onmouseover="this.style.transform='scale(1.1)';" onmouseout="this.style.transform='scale(1)';" />
              AIVA Laundry
          </div>
          <div class="hamburger">☰</div>
        <div class="nav-links">
                <a href="/">Home</a>
                <a href="/about">About Us</a>
                <a href="/order">Order</a>
                <a href="/categories">Categories</a>
                <a href="/contact">Contact Us</a>
                {% if current_user.is_authenticated %}
                    <a href="/user/orders">My Orders</a>
                    <a href="/logout">Logout</a>
                {% else %}
                    <a href="/user/login">Login</a>
                    <a href="/user/register">Register</a>
                {% endif %}
            </div>
      </nav>
      <section>
          <h1>Admin Dashboard</h1>

          <h2>Add Item</h2>
          <form id="add-item-form">
              <input type="text" id="item-name" placeholder="Item Name" required>
              <input type="text" id="item-description" placeholder="Description" required>
              <input type="text" id="item-category" placeholder="Category" required>
              <input type="number" id="item-stock" placeholder="Stock" required>
              <button type="submit">Add Item</button>
          </form>

          <h2>Orders</h2>
          <div id="orders-list">
              <table style="width: 100%; border-collapse: collapse; color: #FFFFFF;">
                  <thead>
                      <tr style="background-color: #FF7043;">
                          <th style="padding: 0.5rem;">Order ID</th>
                          <th style="padding: 0.5rem;">Item</th>
                          <th style="padding: 0.5rem;">Customer Email</th>
                          <th style="padding: 0.5rem;">Payment Method</th>
                          <th style="padding: 0.5rem;">Status</th>
                          <th style="padding: 0.5rem;">Delivery Method</th>
                          <th style="padding: 0.5rem;">Set Delivery</th>
                          <th style="padding: 0.5rem;">Update Status</th>
                          <th style="padding: 0.5rem;">Order History</th>
                      </tr>
                  </thead>
                  <tbody id="orders-table-body"></tbody>
              </table>
          </div>
      </section>
      <footer>
          <p>© 2025 AIVA Laundry. All rights reserved.</p>
      </footer>
      <script src="/static/script.js"></script>
      <script>
          // Fetch and display orders
          fetch('/api/admin/orders')
              .then(response => response.json())
              .then(orders => {
                  const tbody = document.getElementById('orders-table-body');
                  orders.forEach(order => {
                      const row = document.createElement('tr');
                      row.innerHTML = `
                          <td style="padding: 0.5rem;">${order.id}</td>
                          <td style="padding: 0.5rem;">${order.item}</td>
                          <td style="padding: 0.5rem;">${order.email}</td>
                          <td style="padding: 0.5rem;">${order.payment_method}</td>
                          <td style="padding: 0.5rem;">${order.status}</td>
                          <td style="padding: 0.5rem;">${order.delivery_method || 'Not Set'}</td>
                          <td style="padding: 0.5rem;">
                              <select onchange="setDelivery(${order.id}, this.value)">
                                  <option value="">Select</option>
                                  <option value="Motorcycle">Motorcycle</option>
                                  <option value="Vehicle">Vehicle</option>
                              </select>
                          </td>
                          <td style="padding: 0.5rem;">
                              <select onchange="updateStatus(${order.id}, this.value)">
                                  <option value="">Select</option>
                                  <option value="Pending">Pending</option>
                                  <option value="Processing">Processing</option>
                                  <option value="Shipped">Shipped</option>
                                  <option value="Delivered">Delivered</option>
                              </select>
                          </td>
                          <td style="padding: 0.5rem;">
                              <button onclick="viewOrderHistory(${order.id})">View History</button>
                          </td>
                      `;
                      tbody.appendChild(row);
                  });
              });

          // Add item
          document.getElementById('add-item-form').addEventListener('submit', (e) => {
              e.preventDefault();
              const data = {
                  name: document.getElementById('item-name').value,
                  description: document.getElementById('item-description').value,
                  category: document.getElementById('item-category').value,
                  stock: document.getElementById('item-stock').value
              };
              fetch('/api/admin/add_item', {
                  method: 'POST',
                  headers: { 'Content-Type': 'application/json' },
                  body: JSON.stringify(data)
              })
              .then(response => response.json())
              .then(result => {
                  if (result.success) {
                      alert('Item added successfully!');
                      document.getElementById('add-item-form').reset();
                  }
              });
          });

          // Set delivery method
          function setDelivery(orderId, method) {
              fetch(`/api/admin/set_delivery/${orderId}`, {
                  method: 'POST',
                  headers: { 'Content-Type': 'application/json' },
                  body: JSON.stringify({ method })
              })
              .then(response => response.json())
              .then(result => {
                  if (result.success) {
                      alert('Delivery method updated!');
                      location.reload();
                  }
              });
          }

          // Update order status
          function updateStatus(orderId, status) {
              fetch(`/api/admin/update_status/${orderId}`, {
                  method: 'POST',
                  headers: { 'Content-Type': 'application/json' },
                  body: JSON.stringify({ status })
              })
              .then(response => response.json())
              .then(result => {
                  if (result.success) {
                      alert('Status updated!');
                      location.reload();
                  }
              });
          }

          // View order history (placeholder for now)
          function viewOrderHistory(orderId) {
              alert(`Order history for order ${orderId} (to be implemented)`);
          }
      </script>
  </body>
  </html>